create sequence users_table_id_seq;

alter sequence users_table_id_seq owner to postgres;

create sequence wallets_id_seq_gen;

alter sequence wallets_id_seq_gen owner to postgres;

create table users
(
    id                bigserial
        primary key
        unique,
    login             varchar                                   not null
        unique,
    password          varchar                                   not null,
    email             varchar                                   not null
        unique,
    registration_date date                                      not null,
    score             numeric default 0.00,
    role              varchar default 'USER'::character varying not null,
    is_deleted        boolean default false                     not null
);

alter table users
    owner to postgres;

create table users_data
(
    id            bigserial
        unique,
    user_id       bigint                                                               not null
        unique
        constraint users_data_fk
            references users,
    first_name    varchar   default 'unknown'::bpchar,
    last_name     varchar   default 'unknown'::bpchar,
    country       varchar   default 'unknown'::bpchar,
    phone_number  varchar   default 'unknown'::bpchar,
    date_of_birth date      default '2000-01-01 00:00:00'::timestamp without time zone,
    changed       timestamp default '2000-01-01 00:00:00'::timestamp without time zone not null
);

alter table users_data
    owner to postgres;

create table wallets
(
    id      bigserial
        unique,
    balance numeric default 0.00,
    user_id integer not null
        unique
        constraint wallets_users_id_fk
            references users
);

alter table wallets
    owner to postgres;

create table games
(
    id          bigserial
        unique,
    type        varchar   not null,
    time_create timestamp not null,
    finish      timestamp,
    status      varchar   not null,
    result      numeric
);

alter table games
    owner to postgres;

create table users_games
(
    id      bigserial
        unique,
    game_id integer not null
        constraint users_games_games_id_fk
            references games (id),
    user_id integer not null
        constraint users_games_users_id_fk
            references users
);

alter table users_games
    owner to postgres;

create table roulette_games
(
    id      bigserial
        unique,
    game_id integer not null
        unique
        constraint roulette_games_games_id_fk
            references games (id)
            on update cascade on delete cascade,
    spin    integer,
    wins    integer,
    losses  integer,
    result  numeric,
    status  varchar not null,
    changed timestamp
);

alter table roulette_games
    owner to postgres;

create table bets_roulette
(
    id              bigserial
        unique,
    game_id         integer not null
        constraint bets_roulette_roulette_games_game_id_fk
            references roulette_games (game_id)
            on update cascade on delete cascade,
    type            varchar not null,
    amount          numeric,
    roulette_number integer,
    player_choise   varchar,
    winning_amount  numeric default 0
);

alter table bets_roulette
    owner to postgres;

create table texasholdem_games
(
    id             bigserial
        unique,
    game_id        integer                               not null
        constraint texasholdem_games_games_id_fk
            references games (id),
    bank           numeric default 0.00                  not null,
    player_preflop varchar default ''::character varying not null,
    casino_preflop varchar default ''::character varying not null,
    flop           varchar default ''::character varying not null,
    tern           varchar default ''::character varying not null,
    river          varchar default ''::character varying not null,
    result         numeric default 0.00,
    status         varchar                               not null,
    changed        timestamp
);

alter table texasholdem_games
    owner to postgres;

